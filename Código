/*
 * To change this license header, choose License Headers in Project Properties.
 * To change this template file, choose Tools | Templates
 * and open the template in the editor.
 */
package projetov1;

import java.io.FileNotFoundException;
import java.io.File;
import java.util.Scanner;

public class ProjetoV1 {

    public static void main(String[] args) throws FileNotFoundException {
        String[][] dadosFicheiro = new String[22680][5];

        int linhas = guardarDados(dadosFicheiro);
        analisarDados(dadosFicheiro, linhas);
    }

    public static int guardarDados(String[][] dadosFicheiro) throws FileNotFoundException {
        int qtdlinhas = 0;
        Scanner lerFicheiro = new Scanner(new File("DAYTON.csv"));

        String lixo = lerFicheiro.nextLine();
        while (lerFicheiro.hasNextLine()) {
            String line = lerFicheiro.nextLine();
            String[] espacos = line.split("[-| |:|,|]");
            dadosFicheiro[qtdlinhas][0] = espacos[0];
            dadosFicheiro[qtdlinhas][1] = espacos[1];
            dadosFicheiro[qtdlinhas][2] = espacos[2];
            dadosFicheiro[qtdlinhas][3] = espacos[3];
            dadosFicheiro[qtdlinhas][4] = espacos[6];
            qtdlinhas++;
        }
        lerFicheiro.close();
        return qtdlinhas;
    }

    public static void analisarDados(String[][] dadosFicheiro, int linhas) {
        Scanner ler = new Scanner(System.in);
        System.out.println("Introduza a resolução temporal: ");
        String time = ler.nextLine();
        switch (time) {
            case "diario":
                System.out.println("Escolha o dia, ano e mes que pretende analisar!");
                String dia = ler.nextLine();
                String mes1 = ler.nextLine();
                String ano1 = ler.nextLine();
                verificarDia(dadosFicheiro, ano1, mes1, dia, linhas);
                break;
            case "mensal":
                System.out.println("Escolha o ano e o que pretende analisar!");
                String ano2 = ler.nextLine();
                String mes = ler.nextLine();
                verificarMes(dadosFicheiro, ano2, mes, linhas);
                break;
            case "anual":
                System.out.println("Escolha o ano que pretende analisar!");
                String ano = ler.nextLine();
                verificarAno(dadosFicheiro, ano, linhas);
                break;
            case "periodo do dia":
                System.out.println("Introduza o periodo do dia que pretende analisar!");
                String periodo = ler.nextLine();
                int lowerLimit = 0,
                 upperLimit = 0;
                switch (periodo) {
                    case "Madrugada":
                        lowerLimit = 00;
                        upperLimit = 05;
                        System.out.println("Introduzao o ano, o mes e o dia: ");
                        String anoPeriodo=ler.nextLine();
                        String mesPeriodo=ler.nextLine();
                        String diaPeriodo=ler.nextLine();
                        
                        verificarPeriodo(dadosFicheiro, lowerLimit, upperLimit, anoPeriodo, mesPeriodo,diaPeriodo, linhas);
                        break;
                    case "Manha":
                        lowerLimit = 06;
                        upperLimit = 11;
                        System.out.println("Introduzao o ano, o mes e o dia: ");
                        String anoPeriodo1=ler.nextLine();
                        String mesPeriodo1=ler.nextLine();
                        String diaPeriodo1=ler.nextLine();
                        verificarPeriodo(dadosFicheiro, lowerLimit, upperLimit, anoPeriodo1, mesPeriodo1,diaPeriodo1, linhas);
                        break;
                    case "Tarde":
                        lowerLimit = 12;
                        upperLimit = 17;
                        System.out.println("Introduzao o ano, o mes e o dia: ");
                        String anoPeriodo2=ler.nextLine();
                        String mesPeriodo2=ler.nextLine();
                        String diaPeriodo2=ler.nextLine();
                        verificarPeriodo(dadosFicheiro, lowerLimit, upperLimit, anoPeriodo2, mesPeriodo2,diaPeriodo2, linhas);
                        break;
                    case "Noite":
                        lowerLimit = 18;
                        upperLimit = 23;
                        System.out.println("Introduzao o ano, o mes e o dia: ");
                        String anoPeriodo3=ler.nextLine();
                        String mesPeriodo3=ler.nextLine();
                        String diaPeriodo3=ler.nextLine();
                        verificarPeriodo(dadosFicheiro, lowerLimit, upperLimit, anoPeriodo3, mesPeriodo3,diaPeriodo3, linhas);
                        break;
                }
        }
    }

    public static void verificarDia(String[][] dadosFicheiro, String ano1, String mes1, String dia, int linhas) {
        int total = 0;
        for (int posicao = 0; posicao < linhas; posicao++) {
            if (ano1.equals(dadosFicheiro[posicao][0]) && mes1.equals(dadosFicheiro[posicao][1]) && dia.equals(dadosFicheiro[posicao][2])) {
                total = Integer.parseInt(dadosFicheiro[posicao][4]) + total;
            }

        }
        System.out.println(total);
    }

    public static void verificarMes(String[][] dadosFicheiro, String ano2, String mes, int linhas) {
        int soma = 0;
        for (int posicao = 0; posicao < linhas; posicao++) {
            if (ano2.equals(dadosFicheiro[posicao][0]) && mes.equals(dadosFicheiro[posicao][1])) {
                soma = Integer.parseInt(dadosFicheiro[posicao][4]) + soma;
                System.out.println(dadosFicheiro[posicao][4]);
            }
        }
        System.out.println(soma);
    }

    public static void verificarAno(String[][] dadosFicheiro, String ano, int linhas) {
        int somatorio = 0;
        for (int posicao = 0; posicao < linhas; posicao++) {
            if (ano.equals(dadosFicheiro[posicao][0])) {
                somatorio = Integer.parseInt(dadosFicheiro[posicao][4]) + somatorio;
            }
        }
        System.out.println(somatorio);
    }

    public static void verificarPeriodo(String[][] dadosFicheiro, int lowerLimit, int upperLimit, String anoPeriodo, String mesPeriodo, String diaPeriodo, int linhas) {
        int somar = 0;
        for (int posicao = 0; posicao < linhas; posicao++) {
            int valor = Integer.parseInt(dadosFicheiro[posicao][3]);
            if (valor >= lowerLimit && valor <= upperLimit && anoPeriodo.equals(dadosFicheiro[posicao][0]) && mesPeriodo.equals(dadosFicheiro[posicao][1]) && diaPeriodo.equals(dadosFicheiro[posicao][2])) {
                System.out.println(dadosFicheiro[posicao][4]);
                somar = Integer.parseInt(dadosFicheiro[posicao][4]) + somar;
            }
        }
        System.out.println(somar);
    }

}
